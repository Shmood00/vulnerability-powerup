window.TrelloPowerUp.initialize({
    "card-badges": function(t){
        return t.card("name", "labels").then(function(card){
            
            os_type = card.name;

            os_version = card.labels[0].name;

            return fetch(`https://services.nvd.nist.gov/rest/json/cves/2.0?cpeName=cpe:2.3:o:fortinet:${os_type.toLowerCase()}:${os_version}:*:*:*:*:*:*:*`)
            .then(function(response){
                return response.json();
            }).then(function(vulnData){
                // response
                vulns = vulnData.vulnerabilities;

                //number of vulns
                numberOfVulns = vulns.length;

                //loop through found vulns
                for(let i = 0; i < vulns.length; i++){
                    console.log(vulns[i].cve.references[0].url);
                }



            })

            
        });
    },

    
});